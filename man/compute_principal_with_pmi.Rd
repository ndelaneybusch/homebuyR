% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fct_mortgages.R
\name{compute_principal_with_pmi}
\alias{compute_principal_with_pmi}
\title{Compute Affordable Mortgage Principal Including PMI}
\usage{
compute_principal_with_pmi(
  monthly_housing_budget,
  monthly_non_mortgage_costs = 0,
  rate_per_month,
  n_payments_total,
  down_payment_pct = NULL,
  down_payment_dollars = NULL,
  prop_tax_rate_annual = NULL,
  pmi_rate_annual = NULL,
  pmi_threshold_pct = 20
)
}
\arguments{
\item{monthly_housing_budget}{Numeric. The total maximum amount available
for all housing costs per month.}

\item{monthly_non_mortgage_costs}{Numeric. The sum of fixed monthly costs
*excluding* mortgage P&I and property taxes (e.g., home insurance,
HOA dues, other fixed monthly fees). Defaults to 0.}

\item{rate_per_month}{Numeric. The interest rate per month (e.g., annual
rate / 12 / 100). Must be non-negative.}

\item{n_payments_total}{Integer. The total number of payments over the
life of the loan (e.g., 360 for 30 years). Must be positive.}

\item{down_payment_pct}{Numeric. Optional. The down payment as a percentage
of the home price (e.g., 20 for 20%). Must be between 0 (inclusive) and
100 (exclusive). Provide either this OR `down_payment_dollars`.}

\item{down_payment_dollars}{Numeric. Optional. The fixed dollar amount of the
down payment. Must be non-negative. Provide either this OR
`down_payment_pct`.}

\item{prop_tax_rate_annual}{Numeric. Optional. Estimated annual property
tax rate as a percentage of home value (e.g., 1.2 for 1.2%). If provided
and > 0, property tax is factored into the affordability calculation.
Defaults to NULL (property tax not factored in).}

\item{pmi_rate_annual}{Numeric. Optional. The annual PMI rate expressed as a
percentage of the loan amount (e.g., 0.5 for 0.5%). Defaults to NULL (PMI
not factored in unless down payment is below `pmi_threshold_pct`).}

\item{pmi_threshold_pct}{Numeric. Optional. The down payment percentage
threshold below which PMI is applied. Defaults to 20.}
}
\value{
Numeric. The calculated maximum affordable loan principal,
  considering PMI.
}
\description{
Calculates the maximum affordable loan principal based on a total monthly
housing budget, other non-mortgage costs, loan terms, property taxes, and
Private Mortgage Insurance (PMI) when applicable.
}
\details{
Allows specifying the down payment either as a percentage of the home price
(`down_payment_pct`) or as a fixed dollar amount (`down_payment_dollars`).
Exactly one of these must be provided.

PMI is typically required when the down payment is less than a certain
threshold (e.g., 20%) and is calculated as a percentage of the loan amount.
}
\examples{
# -- Using Percentage Down Payment --
# Example 1: Sufficient \% down payment (20\%), no PMI applied
compute_principal_with_pmi(
  monthly_housing_budget = 2500,
  monthly_non_mortgage_costs = 300,
  rate_per_month = 0.06 / 12,
  n_payments_total = 360,
  prop_tax_rate_annual = 1.2,
  down_payment_pct = 20,
  pmi_rate_annual = 0.5
)
# Should match compute_affordable_principal result: approx 336815

# Example 2: Low \% down payment (10\%), PMI applied
compute_principal_with_pmi(
  monthly_housing_budget = 2500,
  monthly_non_mortgage_costs = 300,
  rate_per_month = 0.06 / 12,
  n_payments_total = 360,
  prop_tax_rate_annual = 1.2,
  down_payment_pct = 10,
  pmi_rate_annual = 0.5
)
# Expect result lower than Ex 1 due to PMI cost: approx 317717

# -- Using Dollar Down Payment --
# Example 3: Fixed $ down payment, sufficient to avoid PMI
# (Down payment $50k on a hypothetical ~$400k house > 10\% threshold)
compute_principal_with_pmi(
  monthly_housing_budget = 2000,
  monthly_non_mortgage_costs = 200,
  rate_per_month = 0.07 / 12,
  n_payments_total = 360,
  prop_tax_rate_annual = 1.0,
  down_payment_dollars = 50000,
  pmi_rate_annual = 0.6,
  pmi_threshold_pct = 10
)
# Expected: approx 258346 (Implies HP approx 308346, DP is ~16\% > 10\%)

# Example 4: Fixed $ down payment, insufficient to avoid PMI
# (Down payment $20k on a hypothetical ~$300k house < 10\% threshold)
compute_principal_with_pmi(
  monthly_housing_budget = 2000,
  monthly_non_mortgage_costs = 200,
  rate_per_month = 0.07 / 12,
  n_payments_total = 360,
  prop_tax_rate_annual = 1.0,
  down_payment_dollars = 20000,
  pmi_rate_annual = 0.6,
  pmi_threshold_pct = 10
)
# Expected: approx 250516 (Implies HP approx 270516, DP is ~7.4\% < 10\%)

}
