% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fct_refinance.R
\name{calculate_refinance_benefit_curve}
\alias{calculate_refinance_benefit_curve}
\title{Calculate Refinance Benefit Over Time}
\usage{
calculate_refinance_benefit_curve(
  principal,
  rate_per_month_old,
  rate_per_month_new,
  n_payments_remaining,
  closing_costs,
  tax_rate = 0.25,
  investment_return_annual = 0,
  lump_sum_paydown = 0,
  mid_limit = 750000,
  max_eval_months = n_payments_remaining
)
}
\arguments{
\item{principal}{Numeric. Remaining principal on existing loan.
Must be positive.}

\item{rate_per_month_old}{Numeric. Monthly interest rate of existing loan (as decimal).
Must be non-negative.}

\item{rate_per_month_new}{Numeric. Monthly interest rate of refinance loan (as decimal).
Must be non-negative.}

\item{n_payments_remaining}{Integer. Months remaining on existing loan.
Must be positive.}

\item{closing_costs}{Numeric. Total cost of refinancing.
Must be non-negative.}

\item{tax_rate}{Numeric. Marginal tax rate for interest deduction (as decimal).
Must be between 0 and 1. Default: 0.25.}

\item{investment_return_annual}{Numeric. After-tax annual return rate for investing savings (as decimal).
Must be non-negative. Default: 0.0.}

\item{lump_sum_paydown}{Numeric. Optional additional principal payment at refinance.
Must be non-negative. Default: 0.}

\item{mid_limit}{Numeric. Mortgage interest deduction limit.
Must be non-negative. Default: 750000.}

\item{max_eval_months}{Integer. Maximum months to evaluate.
Must be positive. Default: n_payments_remaining.}
}
\value{
List containing:
  - months: Vector of evaluation months (1 to max_eval_months)
  - net_benefits: Vector of cumulative net benefits for each month
  - breakeven_month: First month where benefit > 0 (NA if none)
  - old_payment: Monthly payment on existing loan
  - new_payment: Monthly payment on refinance loan
  - monthly_savings: Difference in monthly payments
}
\description{
Computes the cumulative net benefit of refinancing vs. keeping existing loan
for each month of a specified holding period. Handles both beneficial refinances
(rate reductions) and detrimental refinances (rate increases) by properly
accounting for investment opportunities or additional costs.
}
\examples{
# Basic refinance analysis: 300k remaining, 6\% to 4\%, 25 years left
result <- calculate_refinance_benefit_curve(
  principal = 300000,
  rate_per_month_old = 0.06 / 12,
  rate_per_month_new = 0.04 / 12,
  n_payments_remaining = 300,
  closing_costs = 5000
)

# With investment return and lump sum paydown
result2 <- calculate_refinance_benefit_curve(
  principal = 300000,
  rate_per_month_old = 0.06 / 12,
  rate_per_month_new = 0.04 / 12,
  n_payments_remaining = 300,
  closing_costs = 5000,
  investment_return_annual = 0.05,
  lump_sum_paydown = 20000
)
}
